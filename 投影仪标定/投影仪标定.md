# 投影仪标定

## 参考

 1.Novel method for structured light system calibration. 



## 简述

​	标定在三维感知领域起着不可替代的作用，其中比较有名的有张氏标定法，Tsai两步法，分层逐步标定法，基于Kruppa的自标定法等等。其中常用的标定法为张氏标定法。但是三维感知中，有一些主动投射模型不适合张氏标定法，结果造成三维感知精度不高，出现重影，漏洞等现象。为了解决主动投射标定问题，拟研究伪相机法。

​	伪相机法可以理解为已知景物点3D坐标寻找其在投影仪图像中对应的像素点坐标的过程，其优点在于：寻找的过程不需要知道摄像机的内外参数，故投影仪的标定不依赖于摄像机的参数，避免了摄像机标定误差的传播。



## 内容

​	本次以相移法作为研究对象。为实现投影仪内外参数的标定，一些学者将投影仪看作伪相机，借助摄像机生成景物在投影仪成像平面中的虚拟图像，进而用标定摄像机的方法对投影仪进行标定，此过程的关键在于虚拟图像的生成。通过相移法，借助相移编码的特性逐一寻找投影仪成像平面与摄像机成像平面中的匹配点。该方法用投影仪向标定板先后投射两组横向、纵向的相移编码图案并用摄像机采集图像。如下图1所示：

| ![](\picture\1.png)                                          | ![](\picture\2.png) |
| ------------------------------------------------------------ | ------------------- |
| a）编码条纹：从左向右依次是相位为-120°、0°和120°的条纹以及参考线图案在摄像机中的成像 | （b）投影仪匹配结果 |

​																			图1 摄像机与投影仪之间的像素匹配



其中以水平三步相移图案为例，生成三步相移的函数为：
$$
I_1(x,y)=I^`(x,y)+I^"(x,y)cos[\phi(x,y)-2\pi/3]
$$

$$
I_2(x,y)=I^`(x,y)+I^"(x,y)cos[\phi(x,y)]
$$

$$
I_3(x,y)=I^`(x,y)+I^"(x,y)cos[\phi(x,y)+2\pi/3]
$$

​	其中I^'(x,y)是函数值的平均值，I^"(x,y)是函数值的调制，\phi(x,y)为相移值；

根据公式上述公式可得：
$$
\phi(x,y)=arctan(\sqrt{3}(I_1-I_3)/(2I_2-I_1-I_3))
$$
该函数的范围为0-2PI

​	相移值可以表示出图案中的每一行位置，但是不能表示每一个像素的位置。因此，本次准备添加一点以及过该点的一条水平中心线。并将该直线上的相移值定位0，通过这条线上的像素值，我们就可以计算出这些像素的平均相移值：
$$
\phi_0=\sum_{n=0}^{N}{\phi_n(i,j)}
$$
其中N表示该线上所有像素的数量，对于这些像素的绝对相移值为0，因此我们可以通过phi_0 进行转换，公示如下：
$$
\phi_a(i,j)=\phi(i,j)-\phi_0
$$
​	通过获取绝对相移映射关系，我们就可以得到相机的像素和投射器的像素之间的点到线的映射关系。
通过水平三步相移图案，我们可以获取相机像素与投射器像素之间的点到线的映射，以此类推，我们可以得到垂直三步相移图案，也可以获取到相机像素与投射器像素之间的点到线的映射。两者相结合，我们便可以获取相机像素与投射器像素之间的点到点的映射关系。至此，我们便得到了相机和投射器的像素级对应关系。



## 优缺点

​	此方法的优点在于投影仪的标定与摄像机的标定相独立，不会产生摄像机参数标定误差的二次传播；缺点是只适用于相移编码等连续条纹，图案匹配精度有限。